var blog={editor:"",init:function(){},initEditor:function(){blog.editor=new SimpleMDE({element:document.getElementById("MarkDownEditor"),toolbar:[{name:"savePost",action:function(){blog.savePost()},className:"fa fa-floppy-o",title:"Save Post"},"|","undo","redo","bold","italic","strikethrough","heading","|","quote","unordered-list","ordered-list","table","horizontal-rule","|","link","image",{name:"addMedia",action:function(){blog.openMediaEditor()},className:"fa fa-folder-open",title:"add media"},"code","clean-block","|","preview","side-by-side","fullscreen","guide"]});blog.setAlertMessage("Auto save is on, post will be saved every 2 minutes","info");setInterval(function(){blog.savePost()},12e4)},openMediaEditor:function(){window.open("/Media","_blank")},setAlertMessage:function(n,t){var i=$("#alertbanner"),r=$("#alertmessage");i.removeClass("alert-success");i.removeClass("alert-warning");i.removeClass("alert-danger");i.removeClass("alert-primary");i.addClass("alert-"+t);r.html(n);i.show().delay(3e4).fadeOut()},savePost:function(){var n=blog.getPost();$.ajax({type:"post",url:"/Blog/SavePost",data:n,success:function(n,t,i){if(i.status=="200"){n.isSuccess==!0?blog.setAlertMessage(n.message,"success"):blog.setAlertMessage(n.message,"danger");return}},error:function(n){n.status!="200"&&alert("Failed to save the post "+n.status+" "+n.statusText)},dataType:"json"})},getPost:function(){return{Id:$("#Id").val(),Title:$("#Title").val(),Content:blog.editor.value(),UtcPublishDate:$("#UtcPublishDate").val(),UtcCreatedOn:$("#UtcCreatedOn").val(),CreatedByUserId:$("#CreatedByUserId").val()}},initShowdown:function(){showdown.extension("bootstrap-tables",function(){return[{type:"output",filter:function(n){var t=$("<div><\/div>").html(n);return $("table",t).each(function(){var n=$(this);n.addClass("table table-striped table-bordered").wrap('<div class="class table-responsive"><\/div>')}),t.html()}}]})},getHtml:function(n){var t=new showdown.Converter({tables:!0,strikethrough:!0,extensions:["bootstrap-tables"]});return t.setFlavor("github"),t.makeHtml(n)},initPostHtml:function(){blog.postObserver=new IntersectionObserver(function(n){n[0].isIntersecting===!0&&blog.getPostHtml(n[0].target)},{threshold:[0]});$("[data-postarea]").each(function(n,t){blog.postObserver.observe(t);n<5&&blog.getPostHtml(t)})},getPostHtml:function(n){var i=$(n).find("[data-post]"),t,r;i!==null&&i!=undefined&&(t=i[0],t.innerHTML==null||t.innerHTML==undefined||t.innerHTML=="")&&(r=$(n).find("input[type=hidden]").val(),$.getJSON("/Blog/PostContent/"+r,function(n){n!=null&&n!=undefined&&($(t).append(blog.getHtml(n.content)),$(t).parent().data("ispreview")&&$(t).parent().height()>768&&$(t).parent().height(768).css("overflow","hidden"))}))},getPostForEdit:function(){var n=$("#Id").val();$.getJSON("/Blog/PostContent/"+n,function(n){n!=null&&n!=undefined&&($("#Title").val(n.title),$("#UtcPublishDate").val(n.publishDate),$("#UtcCreatedOn").val(n.utcCreatedOn),$("#CreatedByUserId").val(n.createdByUserId),blog.editor.value(n.content))})},updateProfilePic:function(){var n=$("#ProfilePicture").val();n!==null&&n!==undefined&&n!==""&&$("#profilePicElement").attr("src",n)},updateAuthor:function(){var n=blog.getAuthor();$.ajax({type:"post",url:"/Blog/Author/Update",data:n,success:function(n,t,i){if(i.status=="200"){n.isSuccess==!0?blog.setAlertMessage("Author information updated succesfully","success"):blog.setAlertMessage("Failed to update the information, try again later","danger");return}},error:function(n){n.status=="200"?blog.setAlertMessage("Author information updated succesfully","success"):blog.setAlertMessage("Failed to update the information, try again later","danger")},dataType:"json"})},getAuthor:function(){return{Id:$("#Id").val(),DisplayName:$("#DisplayName").val(),UtcCreatedOn:$("#UtcCreatedOn").val(),CreatedByUserId:$("#CreatedByUserId").val(),ProfilePicture:$("#ProfilePicture").val(),Website:$("#Website").val()}}};